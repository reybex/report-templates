<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Incoming Goods Label – Full Data</title>
  <style>
    @page {
      size: 51mm 32mm;
      margin: 0;
    }

    * {
      box-sizing: border-box;
    }

    body {
      margin: 0;
      padding: 0;
      font-family: 'Segoe UI', system-ui, sans-serif;
      font-size: 5.5px;
      line-height: 1.25;
      color: #1a1a1a;
    }

    .label-container {
      width: 51mm;
      height: 32mm;
      margin: 0;
      padding: 1.2mm;
      page-break-after: always;
      page-break-inside: avoid;
      display: flex;
      flex-direction: column;
      position: relative;
      background: #fff;
      border: 0.3mm solid #2c3e50;
    }

    .label-container:last-child {
      page-break-after: auto;
    }

    /* Top: Barcode (left) | Identity + weights (right) */
    .label-top {
      display: flex;
      align-items: stretch;
      gap: 1.5mm;
      margin-bottom: 1mm;
      flex: 0 0 auto;
    }

    .barcode-zone {
      width: 20mm;
      flex-shrink: 0;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: flex-start;
      padding: 0.6mm;
      background: #f8f9fa;
      border-radius: 0.5mm;
    }

    .barcode-wrap {
      width: 100%;
      text-align: center;
      line-height: 0;
      margin-bottom: 0.4mm;
    }

    .barcode-image {
      max-width: 18mm;
      max-height: 6mm;
      width: auto;
      height: auto;
      object-fit: contain;
      display: inline-block;
      vertical-align: middle;
    }

    .gtin-text {
      font-size: 4.5px;
      font-family: 'Consolas', 'Monaco', monospace;
      letter-spacing: 0.05em;
      word-break: break-all;
      text-align: center;
      color: #495057;
    }

    .identity-zone {
      flex: 1;
      min-width: 0;
      display: flex;
      flex-direction: column;
      justify-content: flex-start;
    }

    .product-name {
      font-weight: 700;
      font-size: 6.5px;
      margin-bottom: 0.4mm;
      line-height: 1.2;
      word-break: break-word;
      color: #1a1a1a;
    }

    .mat-sku {
      font-size: 5px;
      color: #495057;
      margin-bottom: 0.5mm;
    }

    .mat-sku span {
      margin-right: 1.2mm;
    }

    .weights {
      font-size: 5px;
      color: #2c3e50;
      margin-top: auto;
      padding-top: 0.4mm;
      border-top: 0.15mm solid #e9ecef;
    }

    .weights span {
      margin-right: 1.5mm;
    }

    /* Critical refs: Batch, Expiry, IG – easy to scan */
    .critical-bar {
      display: flex;
      flex-wrap: wrap;
      gap: 1mm 1.5mm;
      padding: 0.6mm 0.8mm;
      margin-bottom: 0.6mm;
      background: #e8f4fd;
      border-radius: 0.4mm;
      border: 0.15mm solid #b8d9f0;
      font-size: 5.5px;
      font-weight: 600;
      color: #1a1a1a;
    }

    .critical-bar .item {
      display: flex;
      align-items: baseline;
      gap: 0.4mm;
    }

    .critical-bar .tag {
      font-size: 4.5px;
      font-weight: 500;
      color: #2c5282;
      text-transform: uppercase;
      letter-spacing: 0.03em;
    }

    .critical-bar .val {
      font-family: 'Consolas', 'Monaco', monospace;
      word-break: break-all;
    }

    /* Secondary: Attr, Variant, License */
    .secondary {
      font-size: 5px;
      color: #495057;
      margin-bottom: 0.5mm;
      padding-top: 0.3mm;
      border-top: 0.12mm solid #e9ecef;
    }

    .secondary span {
      margin-right: 1.5mm;
    }

    .label-footer {
      margin-top: auto;
      padding-top: 0.4mm;
      border-top: 0.12mm solid #dee2e6;
      font-size: 4.5px;
      color: #6c757d;
    }
  </style>
</head>

<body>
  <#if stockItem.enteredQuantity?? && stockItem.enteredQuantity?number gt 0>
    <#list 1..stockItem.enteredQuantity?number as i>
      <div class="label-container">
        <div class="label-top">
          <div class="barcode-zone">
            <div class="barcode-wrap">
              <#if stockItem.material?? && stockItem.material.gtin??>
                <img src="https://barcode.tec-it.com/barcode.ashx?data=${stockItem.material.gtin}" alt="Barcode"
                  class="barcode-image" />
              </#if>
            </div>
          </div>
          <div class="identity-zone">
            <#if stockItem.material??>
              <#if stockItem.material.name??>
                <div class="product-name">${stockItem.material.name}</div>
              </#if>
              <div class="mat-sku">
                <#if stockItem.material.matCode??><span>MAT ${stockItem.material.matCode}</span></#if>
                <#if stockItem.material.sku??><span>SKU ${stockItem.material.sku}</span></#if>
              </div>
            </#if>
            <#if stockItem.material?? && (stockItem.material.netWeight?? || stockItem.material.grossWeight??)>
              <div class="weights">
                <#if stockItem.material.netWeight??>
                  <span>Net ${stockItem.material.netWeight?c}<#if stockItem.material.netWeightUnit??> ${(stockItem.material.netWeightUnit.code)!(stockItem.material.netWeightUnit.name)!""}</#if></span>
                </#if>
                <#if stockItem.material.grossWeight??>
                  <span>Gross ${stockItem.material.grossWeight?c}<#if stockItem.material.grossWeightUnit??> ${(stockItem.material.grossWeightUnit.code)!(stockItem.material.grossWeightUnit.name)!""}</#if></span>
                </#if>
              </div>
            </#if>
          </div>
        </div>

        <#if stockItem.batchnum?? || stockItem.expiryDate?? || stockItem.incomingGoodsNumber??>
          <div class="critical-bar">
            <#if stockItem.batchnum??>
              <div class="item">
                <span class="tag">Batch</span>
                <span class="val">${stockItem.batchnum}</span>
              </div>
            </#if>
            <#if stockItem.expiryDate??>
              <div class="item">
                <span class="tag">Expiry</span>
                <span class="val">${stockItem.expiryDate}</span>
              </div>
            </#if>
            <#if stockItem.incomingGoodsNumber??>
              <div class="item">
                <span class="tag">IG No</span>
                <span class="val">${stockItem.incomingGoodsNumber}</span>
              </div>
            </#if>
          </div>
        </#if>

        <#if (stockItem.readableAttributeCode?? && stockItem.readableAttributeCode?has_content) || (stockItem.readableVariantCode?? && stockItem.readableVariantCode?has_content) || (stockItem.licenseKey?? && stockItem.licenseKey?has_content)>
          <div class="secondary">
            <#if stockItem.readableAttributeCode?? && stockItem.readableAttributeCode?has_content>
              <span>Attr: ${stockItem.readableAttributeCode}</span>
            </#if>
            <#if stockItem.readableVariantCode?? && stockItem.readableVariantCode?has_content>
              <span>Var: ${stockItem.readableVariantCode}</span>
            </#if>
            <#if stockItem.licenseKey?? && stockItem.licenseKey?has_content>
              <span>Lic: ${stockItem.licenseKey}</span>
            </#if>
          </div>
        </#if>

        <#if stockItem.stockHead?? && stockItem.stockHead.postDate??>
          <div class="label-footer">
            Post ${stockItem.stockHead.postDate}
          </div>
        </#if>
      </div>
    </#list>
  </#if>
</body>

</html>
